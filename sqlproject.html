<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Cancer Patient SQL Project</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">EW</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="about.html">About Me</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Projects &amp; Papers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="pdf/associationspaper.pdf">Associations Between Inflammatory Marker Profiles and Cognitive Functioning Paper</a>
    </li>
    <li>
      <a href="pdf/machinetypecommunication.pdf">Machine-Type Communication for Maritime Internet of Things Paper</a>
    </li>
    <li>
      <a href="pdf/vaccine.pdf">Safety and Efficacy of the BNT162b2 mRNA Covid-19 Vaccine Project</a>
    </li>
    <li>
      <a href="https://ericwanghu.github.io/ghedproject.github.io/">Global Health Expenditure Database Project</a>
    </li>
    <li>
      <a href="projects.html">National Oceanic and Atmospheric Association Project</a>
    </li>
    <li>
      <a href="pdf/impactevaluation.pdf">Impact Evaluation of UC San Diego COVID Response Team Wellness and Job Satisfaction Project</a>
    </li>
    <li>
      <a href="pdf/riskmitigation.pdf">Evaluation of Risk Mitigation Behaviors among San Diegans Project</a>
    </li>
    <li>
      <a href="pdf/proposal.pdf">Phase III Double-blind, Placebo-controlled BXCL701 Study Proposal</a>
    </li>
    <li>
      <a href="sqlproject.html">Cancer Patient SQL Project</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="resume.html">
    <span class="fa fa-file fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:&lt;wang.eric@columbia.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/ericwanggg/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/ericwanghu/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Cancer Patient SQL Project</h1>

</div>


<p>My partner Saryu Patel and I created a database of cancer patients
where we stored variables patient ID, cancer type (lookup table), cancer
stage, treatment (lookup table), visit, visit date, visit location (New
York City/Boston/Baltimore), age (months), tumor size, and weight. In
the parent table, we stored the patient ID, cancer type (lookup table),
cancer stage, and treatment type (lookup table). In the child table, we
stored the visit number, visit date, visit location (New York
City/Boston/Baltimore), age (months), tumor size, and weight. We also
created lookup tables for cancer type and treatment type.</p>
<div id="our-code-is-as-follows" class="section level3">
<h3>Our code is as follows:</h3>
<p>CREATE SCHEMA cancer;</p>
<p>USE cancer;</p>
<div id="cancers-table" class="section level4">
<h4>Cancers table</h4>
<p>CREATE TABLE cancers ( PRIMARY KEY (cancer_id), cancer_id TINYINT(2)
UNSIGNED, cancer_type VARCHAR(255) );</p>
</div>
<div id="treatments-table" class="section level4">
<h4>Treatments table</h4>
<p>CREATE TABLE treatments ( PRIMARY KEY (treatment_id), treatment_id
TINYINT(2) UNSIGNED, treatment_type VARCHAR(255) );</p>
</div>
<div id="patients-table-and-index" class="section level4">
<h4>Patients table and index</h4>
<p>CREATE TABLE patients ( PRIMARY KEY (patient_id), patient_id
SMALLINT(4) UNSIGNED, cancer_type TINYINT(2) UNSIGNED, cancer_stage
TINYINT(1) UNSIGNED, treatment_type TINYINT(2) UNSIGNED, FOREIGN KEY
(cancer_type) REFERENCES cancers(cancer_id) ON UPDATE CASCADE, FOREIGN
KEY (treatment_type) REFERENCES treatments(treatment_id) ON UPDATE
CASCADE );</p>
<p>CREATE INDEX cancer_type ON patients(cancer_type);</p>
<p>CREATE INDEX cancer_stage ON patients(cancer_stage);</p>
<p>CREATE INDEX treatment_type ON patients(treatment_type);</p>
</div>
<div id="visits-table-and-index" class="section level4">
<h4>Visits table and index</h4>
<p>CREATE TABLE visits ( PRIMARY KEY (patient_id, visit_num), patient_id
SMALLINT(4) UNSIGNED, visit_num SMALLINT(5) UNSIGNED, visit_location
TINYINT(1) UNSIGNED, age FLOAT(5, 2), tumor_size FLOAT(5, 2), weight
FLOAT(5, 2), FOREIGN KEY (patient_id) REFERENCES patients(patient_id) ON
UPDATE CASCADE );</p>
<p>CREATE INDEX tumor_size ON visits(tumor_size);</p>
<p>CREATE INDEX weight ON visits(weight);</p>
</div>
<div id="enter-data-into-cancers-table" class="section level4">
<h4>Enter data into cancers table</h4>
<p>INSERT INTO cancers (cancer_id, cancer_type) VALUES (1, ‘Acute
Lymphoblastic Leukemia’), (2, ‘Bladder Cancer’), (3, ‘Breast Cancer’),
(4, ‘Cervical Cancer’), (5, ‘Colorectal Cancer’), (6, ‘Esophageal
Cancer’), (7, ‘Fallopian Tube Cancer’), (8, ‘Gallbadder Cancer’), (9,
‘Kidney Cancer’), (10, ‘Liver Cancer’), (11, ‘Lung Cancer’), (12, ‘Mouth
Cancer’), (13, ‘Nasopharyngeal Cancer’), (14, ‘Oral Cancer’), (15,
‘Ovarian Cancer’), (16, ‘Pancreatic Cancer’), (17, ‘Prostate Cancer’),
(18, ‘Skin Cancer’), (19, ‘Stomach Cancer’), (20, ‘Thyroid Cancer’);</p>
</div>
<div id="enter-data-into-treatments-table" class="section level4">
<h4>Enter data into treatments table</h4>
<p>INSERT INTO treatments (treatment_id, treatment_type) VALUES (1,
‘Hematology’), (2, ‘Chemotherapy’), (3, ‘Immunotherapy’), (4, ‘Targeted
Therapy’), (5, ‘Infusion Therapy’), (6, ‘Genetic Testing’), (7,
‘Radiation Therapy’), (8, ‘Surgery’), (9, ‘Blood &amp; Marrow
Transplantation’), (10, ‘Cryotherapy’), (11, ‘Hormone Therapy’), (12,
‘Radiosurgery’);</p>
</div>
<div id="enter-data-into-the-patients-table" class="section level4">
<h4>Enter data into the patients table</h4>
<p>INSERT INTO patients (patient_id, cancer_type, cancer_stage,
treatment_type) VALUES (1, 16, 2, 3), (2, 3, 1, 8), (3, 9, 3, 2);</p>
</div>
<div id="enter-data-into-the-visits-table" class="section level4">
<h4>Enter data into the visits table</h4>
<p>INSERT INTO visits (patient_id, visit_num, visit_location, age,
tumor_size, weight) VALUES (1, 1, 0, 270.00, 40.35, 120.54), (1, 2, 0,
272.40, 36.14, 126.89), (3, 1, 1, 228.80, 80.82, 102.12), (3, 2, 1,
229.20, 70.01, 106.72);</p>
</div>
<div id="view" class="section level4">
<h4>View</h4>
<p>CREATE VIEW patients_by_tumor_size AS SELECT p.patient_id,
p.cancer_type, p.cancer_stage, p.treatment_type, v.visit_num,
v.tumor_size, v.weight, DENSE_RANK() OVER(ORDER BY tumor_size DESC) AS
tumor_size_rank FROM patients AS p INNER JOIN visits AS v ON
p.patient_id = v.patient_id;</p>
</div>
<div id="temporary-table" class="section level4">
<h4>Temporary table</h4>
<p>CREATE TEMPORARY TABLE patients_by_visits AS (SELECT p.patient_id,
p.cancer_type, p.cancer_stage, p.treatment_type, COUNT(visit_num) AS
num_visits FROM patients AS p LEFT JOIN visits AS v ON p.patient_id =
v.patient_id GROUP BY p.patient_id);</p>
<p>SELECT * FROM patients_by_visits HAVING num_visits = 0;</p>
</div>
<div id="cte" class="section level4">
<h4>CTE</h4>
<p>WITH priority AS (SELECT p.patient_id, p.cancer_type, p.cancer_stage,
p.treatment_type, v.visit_num, v.age, v.tumor_size, v.weight, CASE WHEN
p.cancer_stage = 3 THEN ‘High Priority’ ELSE ‘Regular Priority’ END AS
priority_status FROM patients AS p LEFT JOIN visits AS v ON p.patient_id
= v.patient_id ORDER BY p.patient_id)</p>
<p>SELECT * FROM priority HAVING priority_status = ‘High Priority’;</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
